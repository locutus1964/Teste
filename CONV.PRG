REQUEST DBFCDX
CLS
ConvCabecNf()  // Converte CabecNf
QUIT

*********************
PROCEDURE CONVCABECNF()
*********************

  USE CADNF        NEW VIA "DBFCDX"
  USE CABECNF      NEW VIA "DBFCDX"
  SET RELATION TO NNF INTO CADNF
  USE NOVO\CABECNF NEW ALIAS NOVO
  INDEX ON NNF TO TST
  ZAP
  SELECT CABECNF
  DO WHILE ! EOF()
    SELECT CADNF
    IF FOUND()
      @ 24, 00 SAY 'Registro: ' + STR( RECNO() )
      SELECT NOVO
      APPEND BLANK
      REPLACE NNF      WITH CABECNF->NNF
      REPLACE VBASEICM WITH CABECNF->VBASEICM
      REPLACE VEN      WITH CABECNF->VEN
      REPLACE VEICULO  WITH CABECNF->VEICULO
      REPLACE REGIAO   WITH CABECNF->REGIAO
      REPLACE PBRUTO   WITH CABECNF->PBRUTO
      REPLACE PLIQUIDO WITH CABECNF->PLIQUIDO
      REPLACE QTDVOL   WITH CABECNF->QTDVOL
      REPLACE ESPECIE  WITH CABECNF->ESPECIE
      REPLACE CGC      WITH CADNF->CGC
      REPLACE TIP      WITH CADNF->TIP
      REPLACE PED      WITH CADNF->PED
      REPLACE CP1      WITH CADNF->CP1
      REPLACE CP2      WITH CADNF->CP2
      REPLACE CP3      WITH CADNF->CP3
      REPLACE CP4      WITH CADNF->CP4
      REPLACE PE1      WITH CADNF->PE1
      REPLACE PE2      WITH CADNF->PE2
      REPLACE PE3      WITH CADNF->PE3
      REPLACE PE4      WITH CADNF->PE4
      REPLACE CPD      WITH CADNF->CPD
      REPLACE ENT      WITH CADNF->ENT
      REPLACE DEV      WITH CADNF->DEV
      REPLACE FRE      WITH CADNF->FRE
      REPLACE NFI      WITH CADNF->NFI
      REPLACE DEMI     WITH CADNF->DEMI
      REPLACE CVEN     WITH CADNF->CVEN
      REPLACE ICM      WITH CADNF->ICM
      REPLACE DICM     WITH CADNF->DICM
      REPLACE PINT     WITH CADNF->PINT
      REPLACE PCL      WITH CADNF->PCL
      REPLACE NOPE     WITH CADNF->NOPE
      REPLACE EDUP     WITH CADNF->EDUP
      REPLACE BEST     WITH CADNF->BEST
      REPLACE ISS      WITH CADNF->ISS
      REPLACE VISS     WITH CADNF->VISS
      REPLACE CANCELNF WITH CADNF->CANCELNF
      REPLACE COMPET   WITH CADNF->COMPET
      REPLACE DESCONTO WITH CADNF->DESCONTO
      REPLACE BASEICM  WITH CADNF->BASEICM
      REPLACE CCL      WITH CADNF->CCL
      REPLACE TRA      WITH CADNF->TRA
    ENDIF
    SELECT CABECNF
    SKIP
  ENDDO
  CLOSE ALL

RETURN 
